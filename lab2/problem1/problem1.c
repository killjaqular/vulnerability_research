/*
Adonay Pichardo, adonaypichardo@gmail.com

@description
Assignment 2 of 2022 Spring Vulnerability Research at Florida Tech.

Problem 1:
Compile the below program; open in disassembler and compare source code with assembled
instructions. Examine the disassembly; can you identify the integer overflow? Can you
cause the overflow to happen?

*/

#include <stdio.h>

void ParseFileHdr(char* pcFileName){
    FILE* poFile;
    char abHdr[100];
    unsigned long nBytesRead;

    // open the file
    if((poFile = fopen(pcFileName, "rb"))){
        // Move the pointer by reading the data
        fread(abHdr, sizeof(char), 100, poFile);
        fclose(poFile);

        // Get File Position after read
        nBytesRead = ftell(poFile);
        printf("BytesRead: %d 0x%08x\n", nBytesRead, nBytesRead);

        if(nBytesRead > 0){
            printf("Oops Reading Header!\n");
        }

    }else{
        printf("Unable to Open File!\n");
    }
}

int main(int argv, char** argc){
    ParseFileHdr(argc[1]);
    return 0;
}
