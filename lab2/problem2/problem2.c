/*
Adonay Pichardo, adonaypichardo@gmail.com

@description
Assignment 2 of 2022 Spring Vulnerability Research at Florida Tech.

Problem 2:
Create, compile, and analyze your own integer overflow example.

1. Explain the scenarios that your code is vulnerable to the overflow.
    Flag has been declared an unsigned long and the compiler will treat it as such.
    However, to the machine, a byte is just a byte, and therefore, if someone where to
    write the left most bit (usually the sign bit) to 1, the entire interpretation will
    be wrong. Entering -1 will always yield a value larger than 1,000.

2. Provide an example of how to cause the overflow.
    user@host#:_>./problem2
    user@host#:_>Enter a number greater than 1,000. Don't try negative numbers, they
                 obviously won't work!:_>-1

3. What would be the best way to mitigate the vulnerability?
    Use signed integers instead!

*/

#include <stdio.h>

int main(void){
    unsigned long flag;

    printf("Enter a number greater than 1,000. Don't try negative numbers, they obviously won't work!:_> ");

    scanf("%d", &flag);

    printf("flag = %d\n", flag);

    if(flag > 1000){
        printf("Welcome!\n");

    }else{
        printf("Denied!!\n");
    }

    return 0;
}
