/*
Adonay Pichardo, adonaypichardo@gmail.com

@description
Assignment 2 of 2022 Spring Vulnerability Research at Florida Tech.

Problem 2:
Create, compile, and analyze your own integer overflow example. Explain the scenarios
that your code is vulnerable to the overflow. Provide an example of how to cause the
overflow. What would be the best way to mitigate the vulnerability?

*/

#include <stdio.h>
#include <stdbool.h>

bool validateInput(char*);

int main(void){
    int access = 0;
    int flag   = 0;
    char input[8];

    printf("Password:_> ");
    gets(input);

    flag = validateInput(input);

    printf("Using credentials:_> access = %d\nflag = %d\ninput = %s\n",
           access, flag, input);

    if(flag && access){
        printf("Welcome!\n");

    }else{
        printf("Denied!!\n");
    }

    return 0;
}

bool validateInput(char* input){
    return (int) input[9];
}
