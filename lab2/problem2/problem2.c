/*
Adonay Pichardo, adonaypichardo@gmail.com

@description
Assignment 2 of 2022 Spring Vulnerability Research at Florida Tech.

Problem 2:
Create, compile, and analyze your own integer overflow example.

1. Explain the scenarios that your code is vulnerable to the overflow.
    Into the buffer input, you can override the values of access and flag. This is due to
    the insecure nature of gets(). gets() does not stop reading until a '\n' char is read
    somewhere in the stream being read. Filling buffer with more than 8 chars, say 10
    chars, will set access and flag to be greater than 0.

2. Provide an example of how to cause the overflow.
    user@host#:_>./problem2
    user@host#:_>Enter a number greater than 1,000. Don't try negative numbers, they
                 obviously won't work!:_>-1

3. What would be the best way to mitigate the vulnerability?
    Use signed integers instead.

*/

#include <stdio.h>
#include <stdbool.h>

int main(void){
    unsigned long flag;

    printf("Enter a number greater than 1,000. Don't try negative numbers, they obviously won't work!:_> ");

    scanf("%d", &flag);

    printf("flag = %d\n", flag);

    if(flag > 1000){
        printf("Welcome!\n");

    }else{
        printf("Denied!!\n");
    }

    return 0;
}
